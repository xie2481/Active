Array.prototype.find||(Array.prototype.find=function(n){for(var e=0;e<this.length;e++)if(n(this[e],e))return this[e]}),Array.prototype.enhancedConcat=function(n){if("[object Array]"===Object.prototype.toString.call(n))for(var e=0;e<n.length;e++)this.push(n[e]);return this};var EasyTreeview=function(n){var e=n.data,t=document.getElementById(n.el),s=n.draggable,f=n.checkable,u=(n.selectable,n.onClick||new Function),l=n.onChecked||new Function,p=n.onUnchecked||new Function,h=n.onDragged||new Function,v=n.onDropped||new Function,g=-1,x=[],C=[],b=[],E=[];if("[object Array]"!==Object.prototype.toString.call(e)?(console.error("Uncaught TypeError: treeview data should be array."),0):null!==t||(console.error("Uncaught ReferenceError: treeview element does not exist."),0)){var y=function(n,e){var t=n.className.split(" ");-1===t.indexOf(e)&&t.push(e),n.className=t.join(" ")},N=function(n,e){var t=n.className.split(" "),r=t.indexOf(e);-1<r&&t.splice(r,1),n.className=t.join(" ")},o=function(n,e){for(var t in e)n.style[t]=e[t]},k=function(n,e,t){var r=document.createElement(n||"div");for(var a in e){var i=e[a];"[object Object]"===Object.prototype.toString.call(i)?o(r,i):r[a]=i}return function(n,e){for(var t in e)n.addEventListener(t,function(n){n.stopPropagation(),e[t](n)})}(r,t),r},m=function(n,e,t){var r=n.indexOf(e);-1<r&&!t?n.splice(r,1):-1===r&&t&&n.push(e)},O=function(n,t){x.forEach(function(e){e[t]=void 0!==n.find(function(n){return e.index===n})})},j=function(n,e){var t=n.childNodes;for(var r in t)if(-1<t[r].className.split(" ").indexOf(e))return t[r];return-1},r=function(t,r,a){x.forEach(function(n){var e=j(n.obj,r);-1<t.indexOf(n.index)?y(e,a):N(e,a)})},a=function(){var n,t=[],r=(n=[],x.forEach(function(e){var t=!1;x.forEach(function(n){n.parent===e.index&&(t=!0)}),t||n.push(e)}),n);return C.forEach(function(e){r.forEach(function(n){e===n.index&&t.push(e)})}),t},i=function(e){var t=[];return x.forEach(function(n){n.index===x.find(function(n){return n.index===e}).parent&&(t.push(n.index),t.enhancedConcat(i(n.index)))}),t},w=function(e){var t=[];return x.forEach(function(n){n.parent===e&&t.enhancedConcat(n.isBranch?w(n.index):[n.index])}),t},B=function(){var n;n=a(),C=[],n.forEach(function(n){C.push(n),C.enhancedConcat(i(n))}),O(C,"isChecked"),r(C,"node-body","checked")},D=function(){E=[],x.forEach(function(e){void 0!==x.find(function(n){return n.parent===e.index})&&E.push(e.index)}),O(E,"isBranch"),r(E,"node-body","branched")},L=function(){O(b,"isCollapsed"),r(b,"node-body","collapsed"),r(b,"sub-tree","invisible")},S=function(n,c){var d=k("ul",{className:"sub-tree"});return n.forEach(function(n){var i=++g,e=k("li",{className:"branch-node",draggable:s,style:n.style},n.on);n.on&&n.on.click||e.addEventListener("click",function(n){n.stopPropagation(),u(i,x.find(function(n){return n.index===i}))}),s&&(e.addEventListener("dragstart",function(n){n.stopPropagation(),n.dataTransfer.setData("text",String(i)),h(i,x.find(function(n){return n.index===i}))}),e.addEventListener("dragover",function(n){n.preventDefault(),n.stopPropagation(),-1<n.target.className.indexOf("node-text")&&y(n.target,"drag-enter")}),e.addEventListener("dragenter",function(n){n.stopPropagation(),n.preventDefault()}),e.addEventListener("dragleave",function(n){n.stopPropagation(),n.preventDefault(),-1<n.target.className.indexOf("node-text")&&N(n.target,"drag-enter")}),e.addEventListener("drop",function(n){n.stopPropagation(),n.preventDefault(),-1<n.target.className.indexOf("node-text")&&N(n.target,"drag-enter");var e=Number(n.dataTransfer.getData("text"));if(e!==i){var t=n.target.parentNode.parentNode,r=j(t,"sub-tree"),a=x.find(function(n){return n.index===e});a.parent=i,r.appendChild(a.obj),B(),D(),v(i,x.find(function(n){return n.index===i}))}}));var t=JSON.parse(JSON.stringify(n));delete t.children;var r={index:g,parent:c,text:n.text,isBranch:void 0!==n.children,isChecked:n.checked,isCollapsed:n.collapsed,data:t,obj:e};x.push(r);var a=k("div",{className:"node-body"});n.checked&&m(C,i,n.checked),e.appendChild(a);var o=S(n.children||[],g);n.collapsed&&m(b,i,n.collapsed),e.appendChild(o),a.appendChild(k("span",{className:"collapse-switch"},{click:function(n){r.isCollapsed=!r.isCollapsed,r.isBranch&&m(b,i,r.isCollapsed),O(b,"isCollapsed"),L()}})),r.isBranch&&m(E,i,r.isBranch),f&&a.appendChild(k("span",{className:"checkbox"},{click:function(n){var e,t;r.isChecked=!r.isChecked,r.isBranch?(e=i,t=r.isChecked,w(e).forEach(function(n){m(C,n,t)})):m(C,i,r.isChecked),r.isChecked?l(i,x.find(function(n){return n.index===i}),C):p(i,x.find(function(n){return n.index===i}),C),B()}})),a.appendChild(k("span",{className:"node-text",innerHTML:"&nbsp;"+n.text})),d.appendChild(e)}),d};return t.appendChild(S(e,g)),B(),D(),L(),{getNodes:function(){return x},getCheckedNodes:function(){var e=[];return x.forEach(function(n){n.isChecked&&e.push(n)}),e},getTree:function(){var i=function(r){var a=[];return x.forEach(function(n){if(n.parent===r){var e=JSON.parse(JSON.stringify(n.data)),t=i(n.index);0<t.length&&(e.children=t),a.push(e)}}),a};return i(-1)}}}};Array.prototype.find||(Array.prototype.find=function(n){for(var e=0;e<this.length;e++)if(n(this[e],e))return this[e]}),Array.prototype.enhancedConcat=function(n){if("[object Array]"===Object.prototype.toString.call(n))for(var e=0;e<n.length;e++)this.push(n[e]);return this};EasyTreeview=function(n){var e=n.data,t=document.getElementById(n.el),s=n.draggable,f=n.checkable,u=(n.selectable,n.onClick||new Function),l=n.onChecked||new Function,p=n.onUnchecked||new Function,h=n.onDragged||new Function,v=n.onDropped||new Function,g=-1,x=[],C=[],b=[],E=[];if("[object Array]"!==Object.prototype.toString.call(e)?(console.error("Uncaught TypeError: treeview data should be array."),0):null!==t||(console.error("Uncaught ReferenceError: treeview element does not exist."),0)){var y=function(n,e){var t=n.className.split(" ");-1===t.indexOf(e)&&t.push(e),n.className=t.join(" ")},N=function(n,e){var t=n.className.split(" "),r=t.indexOf(e);-1<r&&t.splice(r,1),n.className=t.join(" ")},o=function(n,e){for(var t in e)n.style[t]=e[t]},k=function(n,e,t){var r=document.createElement(n||"div");for(var a in e){var i=e[a];"[object Object]"===Object.prototype.toString.call(i)?o(r,i):r[a]=i}return function(n,e){for(var t in e)n.addEventListener(t,function(n){n.stopPropagation(),e[t](n)})}(r,t),r},m=function(n,e,t){var r=n.indexOf(e);-1<r&&!t?n.splice(r,1):-1===r&&t&&n.push(e)},O=function(n,t){x.forEach(function(e){e[t]=void 0!==n.find(function(n){return e.index===n})})},j=function(n,e){var t=n.childNodes;for(var r in t)if(-1<t[r].className.split(" ").indexOf(e))return t[r];return-1},a=function(t,r,a){x.forEach(function(n){var e=j(n.obj,r);-1<t.indexOf(n.index)?y(e,a):N(e,a)})},i=function(e){var t=[];return x.forEach(function(n){n.index===x.find(function(n){return n.index===e}).parent&&(t.push(n.index),t.enhancedConcat(i(n.index)))}),t},w=function(e){var t=[];return x.forEach(function(n){n.parent===e&&t.enhancedConcat(n.isBranch?w(n.index):[n.index])}),t},B=function(){var n,t,r;t=[],n=[],x.forEach(function(e){var t=!1;x.forEach(function(n){n.parent===e.index&&(t=!0)}),t||n.push(e)}),r=n,C.forEach(function(e){r.forEach(function(n){e===n.index&&t.push(e)})}),C=[],t.forEach(function(n){C.push(n),C.enhancedConcat(i(n))}),O(C,"isChecked"),a(C,"node-body","checked")},D=function(){E=[],x.forEach(function(e){void 0!==x.find(function(n){return n.parent===e.index})&&E.push(e.index)}),O(E,"isBranch"),a(E,"node-body","branched")},L=function(){O(b,"isCollapsed"),a(b,"node-body","collapsed"),a(b,"sub-tree","invisible")},S=function(n,c){var d=k("ul",{className:"sub-tree"});return n.forEach(function(n){var i=++g,e=k("li",{className:"branch-node",draggable:s,style:n.style},n.on);n.on&&n.on.click||e.addEventListener("click",function(n){n.stopPropagation(),u(i,x.find(function(n){return n.index===i}))}),s&&(e.addEventListener("dragstart",function(n){n.stopPropagation(),n.dataTransfer.setData("text",String(i)),h(i,x.find(function(n){return n.index===i}))}),e.addEventListener("dragover",function(n){n.preventDefault(),n.stopPropagation(),-1<n.target.className.indexOf("node-text")&&y(n.target,"drag-enter")}),e.addEventListener("dragenter",function(n){n.stopPropagation(),n.preventDefault()}),e.addEventListener("dragleave",function(n){n.stopPropagation(),n.preventDefault(),-1<n.target.className.indexOf("node-text")&&N(n.target,"drag-enter")}),e.addEventListener("drop",function(n){n.stopPropagation(),n.preventDefault(),-1<n.target.className.indexOf("node-text")&&N(n.target,"drag-enter");var e=Number(n.dataTransfer.getData("text"));if(e!==i){var t=n.target.parentNode.parentNode,r=j(t,"sub-tree"),a=x.find(function(n){return n.index===e});a.parent=i,r.appendChild(a.obj),B(),D(),v(i,x.find(function(n){return n.index===i}))}}));var t=JSON.parse(JSON.stringify(n));delete t.children;var r={index:g,parent:c,text:n.text,isBranch:void 0!==n.children,isChecked:n.checked,isCollapsed:n.collapsed,data:t,obj:e};x.push(r);var a=k("div",{className:"node-body"});n.checked&&m(C,i,n.checked),e.appendChild(a);var o=S(n.children||[],g);n.collapsed&&m(b,i,n.collapsed),e.appendChild(o),a.appendChild(k("span",{className:"collapse-switch"},{click:function(n){r.isCollapsed=!r.isCollapsed,r.isBranch&&m(b,i,r.isCollapsed),O(b,"isCollapsed"),L()}})),r.isBranch&&m(E,i,r.isBranch),f&&a.appendChild(k("span",{className:"checkbox"},{click:function(n){var e,t;r.isChecked=!r.isChecked,r.isBranch?(e=i,t=r.isChecked,w(e).forEach(function(n){m(C,n,t)})):m(C,i,r.isChecked),r.isChecked?l(i,x.find(function(n){return n.index===i}),C):p(i,x.find(function(n){return n.index===i}),C),B()}})),a.appendChild(k("span",{className:"node-text",innerHTML:"&nbsp;"+n.text})),d.appendChild(e)}),d};return t.appendChild(S(e,g)),B(),D(),L(),{getNodes:function(){return x},getCheckedNodes:function(){var e=[];return x.forEach(function(n){n.isChecked&&e.push(n)}),e},getTree:function(){var i=function(r){var a=[];return x.forEach(function(n){if(n.parent===r){var e=JSON.parse(JSON.stringify(n.data)),t=i(n.index);0<t.length&&(e.children=t),a.push(e)}}),a};return i(-1)}}}};Array.prototype.find||(Array.prototype.find=function(n){for(var e=0;e<this.length;e++)if(n(this[e],e))return this[e]}),Array.prototype.enhancedConcat=function(n){if("[object Array]"===Object.prototype.toString.call(n))for(var e=0;e<n.length;e++)this.push(n[e]);return this},EasyTreeview=function(n){var e=n.data,t=document.getElementById(n.el),s=n.draggable,f=n.checkable,u=(n.selectable,n.onClick||new Function),l=n.onChecked||new Function,p=n.onUnchecked||new Function,h=n.onDragged||new Function,v=n.onDropped||new Function,g=-1,x=[],C=[],b=[],E=[];if("[object Array]"!==Object.prototype.toString.call(e)?(console.error("Uncaught TypeError: treeview data should be array."),0):null!==t||(console.error("Uncaught ReferenceError: treeview element does not exist."),0)){var y=function(n,e){var t=n.className.split(" ");-1===t.indexOf(e)&&t.push(e),n.className=t.join(" ")},N=function(n,e){var t=n.className.split(" "),r=t.indexOf(e);-1<r&&t.splice(r,1),n.className=t.join(" ")},o=function(n,e){for(var t in e)n.style[t]=e[t]},k=function(n,e,t){var r=document.createElement(n||"div");for(var a in e){var i=e[a];"[object Object]"===Object.prototype.toString.call(i)?o(r,i):r[a]=i}return function(n,e){for(var t in e)n.addEventListener(t,function(n){n.stopPropagation(),e[t](n)})}(r,t),r},m=function(n,e,t){var r=n.indexOf(e);-1<r&&!t?n.splice(r,1):-1===r&&t&&n.push(e)},O=function(n,t){x.forEach(function(e){e[t]=void 0!==n.find(function(n){return e.index===n})})},j=function(n,e){var t=n.childNodes;for(var r in t)if(-1<t[r].className.split(" ").indexOf(e))return t[r];return-1},a=function(t,r,a){x.forEach(function(n){var e=j(n.obj,r);-1<t.indexOf(n.index)?y(e,a):N(e,a)})},i=function(e){var t=[];return x.forEach(function(n){n.index===x.find(function(n){return n.index===e}).parent&&(t.push(n.index),t.enhancedConcat(i(n.index)))}),t},w=function(e){var t=[];return x.forEach(function(n){n.parent===e&&t.enhancedConcat(n.isBranch?w(n.index):[n.index])}),t},B=function(){var n,t,r;t=[],n=[],x.forEach(function(e){var t=!1;x.forEach(function(n){n.parent===e.index&&(t=!0)}),t||n.push(e)}),r=n,C.forEach(function(e){r.forEach(function(n){e===n.index&&t.push(e)})}),C=[],t.forEach(function(n){C.push(n),C.enhancedConcat(i(n))}),O(C,"isChecked"),a(C,"node-body","checked")},D=function(){E=[],x.forEach(function(e){void 0!==x.find(function(n){return n.parent===e.index})&&E.push(e.index)}),O(E,"isBranch"),a(E,"node-body","branched")},L=function(){O(b,"isCollapsed"),a(b,"node-body","collapsed"),a(b,"sub-tree","invisible")},S=function(n,c){var d=k("ul",{className:"sub-tree"});return n.forEach(function(n){var i=++g,e=k("li",{className:"branch-node",draggable:s,style:n.style},n.on);n.on&&n.on.click||e.addEventListener("click",function(n){n.stopPropagation(),u(i,x.find(function(n){return n.index===i}))}),s&&(e.addEventListener("dragstart",function(n){n.stopPropagation(),n.dataTransfer.setData("text",String(i)),h(i,x.find(function(n){return n.index===i}))}),e.addEventListener("dragover",function(n){n.preventDefault(),n.stopPropagation(),-1<n.target.className.indexOf("node-text")&&y(n.target,"drag-enter")}),e.addEventListener("dragenter",function(n){n.stopPropagation(),n.preventDefault()}),e.addEventListener("dragleave",function(n){n.stopPropagation(),n.preventDefault(),-1<n.target.className.indexOf("node-text")&&N(n.target,"drag-enter")}),e.addEventListener("drop",function(n){n.stopPropagation(),n.preventDefault(),-1<n.target.className.indexOf("node-text")&&N(n.target,"drag-enter");var e=Number(n.dataTransfer.getData("text"));if(e!==i){var t=n.target.parentNode.parentNode,r=j(t,"sub-tree"),a=x.find(function(n){return n.index===e});a.parent=i,r.appendChild(a.obj),B(),D(),v(i,x.find(function(n){return n.index===i}))}}));var t=JSON.parse(JSON.stringify(n));delete t.children;var r={index:g,parent:c,text:n.text,isBranch:void 0!==n.children,isChecked:n.checked,isCollapsed:n.collapsed,data:t,obj:e};x.push(r);var a=k("div",{className:"node-body"});n.checked&&m(C,i,n.checked),e.appendChild(a);var o=S(n.children||[],g);n.collapsed&&m(b,i,n.collapsed),e.appendChild(o),a.appendChild(k("span",{className:"collapse-switch"},{click:function(n){r.isCollapsed=!r.isCollapsed,r.isBranch&&m(b,i,r.isCollapsed),O(b,"isCollapsed"),L()}})),r.isBranch&&m(E,i,r.isBranch),f&&a.appendChild(k("span",{className:"checkbox"},{click:function(n){var e,t;r.isChecked=!r.isChecked,r.isBranch?(e=i,t=r.isChecked,w(e).forEach(function(n){m(C,n,t)})):m(C,i,r.isChecked),r.isChecked?l(i,x.find(function(n){return n.index===i}),C):p(i,x.find(function(n){return n.index===i}),C),B()}})),a.appendChild(k("span",{className:"node-text",innerHTML:"&nbsp;"+n.text})),d.appendChild(e)}),d};return t.appendChild(S(e,g)),B(),D(),L(),{getNodes:function(){return x},getCheckedNodes:function(){var e=[];return x.forEach(function(n){n.isChecked&&e.push(n)}),e},getTree:function(){var i=function(r){var a=[];return x.forEach(function(n){if(n.parent===r){var e=JSON.parse(JSON.stringify(n.data)),t=i(n.index);0<t.length&&(e.children=t),a.push(e)}}),a};return i(-1)}}}};